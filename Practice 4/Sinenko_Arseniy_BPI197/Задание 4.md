Все запросы тестировались с помощью Apache Derby, потому что это единственное с чем у меня есть хоть какой-то опыт. Поэтому в запросах таблицы и колонки в кавычках.<br>
# Задача 1
а)

    select LastName
    from Reader
    where Address like '%Moscow%'

б)

    select "Author", "Title"
    from "Book"
    inner join "Borrowing" on "Borrowing".ISBN = "Book".ISBN
    inner join "Reader" on "Reader".ID = "Borrowing"."ReaderNr"
    where "Reader"."LastName" = 'Иванов' and "Reader"."FirstName" = 'Иван'

в) 

    select "ISBN"
    from "BookCat"
    inner join "Category" C on "BookCat"."CategoryName" = C."CategoryName"
    where C."ParentCat" = 'Mountains'
        and "BookCat"."CategoryName" != 'Travel'
г)

    select distinct "LastName", "FirstName"
    from "Reader"
    inner join "Borrowing" on "Reader".ID = "Borrowing"."ReaderNr"
    where "Borrowing"."ReturnDate" < CURRENT_DATE
д)

    select distinct "LastName", "FirstName"
    from "Borrowing"
    inner join "Reader" on "Reader".ID = "Borrowing"."ReaderNr"
    where ISBN in
    (select ISBN
    from "Borrowing"
    inner join "Reader" on "Reader".ID = "Borrowing"."ReaderNr"
    where "Reader"."LastName" = 'Иванов'
    	and "Reader"."FirstName" = 'Иван')
    and "LastName" != 'Иванов'
    and "FirstName"!= 'Иван'
# Задача 2
а) Если имелось ввиду найти все Connection из Москвы в Тверь:

    select "FromStation", "ToStation", "TrainNr", "Departure", "Arrival"
    from "Connection"
    inner join "Station" on "Station"."Name" = "Connection"."FromStation"
        and "Station"."CityName" = 'Moscow'
    intersect
    select "FromStation", "ToStation", "TrainNr", "Departure", "Arrival"
    from "Connection"
    inner join "Station" on "Station"."Name" = "Connection"."ToStation"
        and "Station"."CityName" = 'Saint-Petersburg'

Если имелось ввиду найти все рейсы, проходящие через Connection из Москвы в Тверь, то:

    select "Train"."TrainNr", "StartStationName", "EndStationName", "Departure", "Arrival"  
      from "Train"  
        inner join "Connection" on "Connection"."TrainNr" = "Train"."TrainNr"  
      inner join "Station" on "Station"."Name" = "Connection"."FromStation"  
      and "Station"."CityName" = 'Moscow'  
      intersect  
     select "Train"."TrainNr", "StartStationName", "EndStationName", "Departure", "Arrival"  
      from "Train"  
        inner join "Connection" on "Connection"."TrainNr" = "Train"."TrainNr"  
      inner join "Station" on "Station"."Name" = "Connection"."ToStation"  
      and "Station"."CityName" = 'Tver'

б) Здесь не знаю как удостоверится, что маршрут является многосегментным.

    select "Train"."TrainNr", "StartStationName", "EndStationName", "Departure", "Arrival"  
      from "Train"  
        inner join "Connection" on "Connection"."TrainNr" = "Train"."TrainNr"  
      and DAY("Connection"."Arrival") = DAY("Connection"."Departure")  
        inner join "Station" on "Station"."Name" = "Connection"."FromStation"  
      and "Station"."CityName" = 'Moscow'  
      intersect  
     select "Train"."TrainNr", "StartStationName", "EndStationName", "Departure", "Arrival"  
      from "Train"  
        inner join "Connection" on "Connection"."TrainNr" = "Train"."TrainNr"  
      and DAY("Connection"."Arrival") = DAY("Connection"."Departure")  
        inner join "Station" on "Station"."Name" = "Connection"."ToStation"  
      and "Station"."CityName" = 'Saint-Petersburg'

в) 
Это а:

    select "Train"."TrainNr", "StartStationName", "EndStationName", "Departure", "Arrival"  
    from "Train"  
    inner join "Connection" on "Train"."TrainNr" = "Connection"."TrainNr"  
    inner join "Station" on "Station"."Name" = "Connection"."FromStation"  
      and "Station"."CityName" = 'Moscow'  
    where "Train"."TrainNr" in (  
	    select "Train"."TrainNr"  
	    from "Train"  
	    inner join "Connection" on "Train"."TrainNr" = "Connection"."TrainNr"  
	    inner join "Station" on "Station"."Name" = "Connection"."ToStation"  
	      and "Station"."CityName" = 'Tver')

Это б:

    select "Train"."TrainNr", "StartStationName", "EndStationName", "Departure", "Arrival"  
    from "Train"  
    inner join "Connection" on "Train"."TrainNr" = "Connection"."TrainNr"  
    inner join "Station" on "Station"."Name" = "Connection"."FromStation"  
      and "Station"."CityName" = 'Moscow'  
    where "Train"."TrainNr" in (  
    select "Train"."TrainNr"  
    from "Train"  
    inner join "Connection" on "Train"."TrainNr" = "Connection"."TrainNr"  
    inner join "Station" on "Station"."Name" = "Connection"."ToStation"  
      and "Station"."CityName" = 'Saint-Petersburg')  
    and DAY("Connection"."Departure") = DAY("Connection"."Arrival")

# Задача 3
Не очень понял, но накидал чего-то.<br>
Здесь A и B это подмножества удовлетворяющие каким-то условиям. Может нужно было записать это в виде нескольких запросов, но я все равно не понял задание.<br>
<code>![3](/Practice%204/Sinenko_Arseniy_BPI197/img/3.JPG "3")
</code><br>
